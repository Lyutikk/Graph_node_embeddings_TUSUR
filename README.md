[![Typing SVG](https://readme-typing-svg.herokuapp.com?color=%2336BCF7&lines=Graph+node+embedding)](https://git.io/typing-svg)

<h1 align="center">Кластерный анализ, эмбеддинг социального графа</h1>

  <p align="center"><img src="https://tusur.ru/assets/logotype-f018cf89deebba58749ec8a3a2bb939b0d4e4c069e9de46a794f93a87698528b.svg" width="250" height="50"></p>
  <h2>Краткое описание</h2>
  <p>Применение методов эмбеддинга узлов графа, на примере социального графа, полученного из социальной сети. 
    Социальный граф, который используется для отработки, представляет участников ЛОКАЛЬНОГО (регионального) спортивного сообщества с открытым входом, это значит, 
    что в данное сообщество могли вступать любые пользователи социальной сети.</p>
  <p>Социальный граф предварительно был очищен от случайных пользователей. Разметка пользователей сделана по ролям: Организатор, тренер, 
    Спортмен-pro (проф. спортсмен), Спортсмен-любитель, Активный участник, спортсмен из другого региона.</p>
    
  <h2>Визуализация графа в пакете <b>gephi/cytoscape</b></h2>
  <p align="left"><img src="https://github.com/Lyutikk/Graph_node_embeddings_TUSUR/blob/master/images/graph_vizualization.png" width="400" height="400"></p>
  <p>Опираясь на модулярность, можно выделить <b>4</b> группы в рамках сообщества:</p>
  <p align="left"><img src="https://github.com/Lyutikk/Graph_node_embeddings_TUSUR/blob/master/images/nodes_by_modularity.png" width="600" height="400"></p>
  <p>Число элементов в каждом векторе - <b>100</b></p>
  <p>Реализовано заданное число случайных блужданий на каждый узел графа - <b>3280</b> (переменная gamma, tqdm - для того, чтобы отслеживать прогресс выполнения цикла).</p>
  <p>Проведена тренеровка алгоритма по сформированным цепочкам случайных блужданий, использован метод <b>word2vec</b> библиотеки gensim.</p>
  <p><b>Параметры функции:</b></p>
  <p>
    <ul>
      <li>window - размер окна</li>
      <li>sg = 1 - это значит будет использована модель skipgrapm</li>
      <li>hs {0, 1}, необязательный параметр) – Если 1, будет использован иерархический софтмакс, если 0 - отрицательное сэмплирование.</li>
      <li>alpha - начальное значение;</li>
      <li>min_alpha - условие остановки алгоритма;</li>
      <li>seed - рэндом сид. Используйте значение 14 при выполнении работы.</li>
    </ul>
   </p> 
   <p>Проведен поиск схожих узлов графа(У казан номер узла и мера сходства между двумя объектами исходной выборки):</p>
   <p>
      <code>Узлы, схожие с 18   [('19', 0.997154951095581), ('21', 0.9949191808700562), ('17', 0.9936828017234802), ('20', 0.9930742383003235), ('1', 0.9805483818054199), ('15', 0.9487687945365906), ('13', 0.9475170969963074), ('16', 0.9446679949760437), ('12', 0.9416887164115906), ('14', 0.9402083158493042)]</code>
   </p>
   <h2>Кластерный анализ</h2>
   <p>Снижение размерностей для визуализации проводилось методами <b>PCA и T-SNE.</p></p>
   <p align="left"><img src="https://github.com/Lyutikk/Graph_node_embeddings_TUSUR/blob/master/images/embendings.png" width="850" height="420"></p>
   <p>Анализ проводился тремя методами:</p>
   <p>
      <ul>
        <li><i>DB-scan</i> - позволяет работать с шумом (по косинусному расстоянию)</li>
        <li><i>Affinity propagation</i> - позволит обнаружить множество кластеров (метод локтя)</li>
        <li><i>K-medoids</i></li>
      </ul>
   </p>
   <h2>DBSCAN</h2>
   <p align="left"><img src="https://github.com/Lyutikk/Graph_node_embeddings_TUSUR/blob/master/images/dbscan_clasters.png" width="400" height="700"></p>
   
   <h2>Affinity propagation</h2>
   <p>Метод локтя позволяет определить оптимальное число кластеров для метода k-means. 
   Видно, что даже используя евклидово расстояние вместо рекомендуемого косинусного методом локтя - удачным решением является разбиение исходных объектов на 3 кластера.</p>
   <p align="left"><img src="https://github.com/Lyutikk/Graph_node_embeddings_TUSUR/blob/master/images/locot.png" width="500" height="300"></p>
   
   <h2>KMeans</h2>
   <p>Реализация k-means в библиотеке scikit-learn не позволяет работать с другими метриками кроме Евклидовой по причине того, 
   что среднее значение не является хорошей оценкой центров кластеров в неевклидовом пространстве. В этом случае, используют альтернативный метод 
   k-medoids. Таким образом, выполнен кластерный анализ методом <b>kmeans</b> с Евклидовым расстоянием и затем k-medoids с косинусным.</p>
   <p align="left"><img src="https://github.com/Lyutikk/Graph_node_embeddings_TUSUR/blob/master/images/clasters.png" width="600" height="300"></p>
   
   <h2>Сравнение и оценка кластерного анализа</h2>
   <p>Использование метрик позволяет оценить качество кластерного анализа и сравнить методы кластеризации. Оценка качества работы методов проводилась по силуэту.</p>
   <p><b>Силуэт</b> показывает насколько качественно объединились объкты в кластеры. Дополнительно приводятся сравнительные метрики -  AMI, ARI по методам: 
   dbscan, kmedoid, affinity propagation.</p>
   <p align="left"><img src="https://github.com/Lyutikk/Graph_node_embeddings_TUSUR/blob/master/images/siluet_clastera.png" width="400" height="300"></p>
   
   <h2>Дополнительно проведен DeepWalk при помощи библиотеки karateclub</h2>
   <p align="left"><img src="https://github.com/Lyutikk/Graph_node_embeddings_TUSUR/blob/master/images/deep_walk_clasters.png" width="1400" height="600"></p>
   
